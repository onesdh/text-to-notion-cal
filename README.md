# π“ ν…μ¤νΈλ¥Ό Notion μΊλ¦°λ”λ΅ (Text to Notion Calendar)

μμ—°μ–΄ ν…μ¤νΈλ΅ μ…λ ¥λ μΌμ • μ •λ³΄λ¥Ό λ¶„μ„ν•μ—¬ Notion λ°μ΄ν„°λ² μ΄μ¤μ— μλ™μΌλ΅ μ¶”κ°€ν•λ” ν”„λ΅μ νΈμ…λ‹λ‹¤. LangGraphλ¥Ό μ‚¬μ©ν•μ—¬ μ΄λ²¤νΈ μ •λ³΄ μ¶”μ¶λ¶€ν„° Notion νμ΄μ§€ μƒμ„±κΉμ§€μ κ³Όμ •μ„ μ›ν¬ν”λ΅μ°λ΅ κµ¬μ„±ν–μµλ‹λ‹¤.

## β¨ μ£Όμ” κΈ°λ¥

- **μμ—°μ–΄ μ²λ¦¬**: "λ‚΄μΌ μ¤ν›„ 2μ‹μ— νμ"μ™€ κ°™μ€ λ¬Έμ¥μ—μ„ λ‚ μ§, μ‹κ°„, μ λ©μ„ μ¶”μ¶ν•©λ‹λ‹¤.
- **LangGraph μ›ν¬ν”λ΅μ°**: μ΄λ²¤νΈ μ¶”μ¶, Notion μ¤ν‚¤λ§ κ²€μ¦, νμ΄μ§€ μƒμ„±μ„ μ²΄κ³„μ μΈ κ·Έλν”„ κΈ°λ°μΌλ΅ μ²λ¦¬ν•©λ‹λ‹¤.
- **Notion μλ™ν™”**: μ¶”μ¶λ μ •λ³΄λ¥Ό λ°”νƒ•μΌλ΅ Notionμ— μ§€μ •λ λ°μ΄ν„°λ² μ΄μ¤μ— μ΄λ²¤νΈ μ •λ³΄λ¥Ό μ €μ¥ν•©λ‹λ‹¤..
- **μλ™ μ¤ν‚¤λ§ μ„¤μ •**: μ§€μ •λ Notion λ°μ΄ν„°λ² μ΄μ¤μ— ν•„μ”ν• μ†μ„±(`Name`, `Date`, `Description`)μ΄ μ—†μΌλ©΄ μλ™μΌλ΅ μƒμ„±ν•©λ‹λ‹¤. 

---

## π› οΈ μ„¤μΉ λ° ν™κ²½ κµ¬μ„±

### 1. ν”„λ΅μ νΈ ν΄λ΅ 

```bash
git clone <your-repository-url>
cd text_to_calendar
```

### 2. κ°€μƒ ν™κ²½ μƒμ„± λ° ν™μ„±ν™”

μ΄ ν”„λ΅μ νΈλ” `conda`λ¥Ό μ‚¬μ©ν• κ°€μƒ ν™κ²½μ„ κ¶μ¥ν•©λ‹λ‹¤.

```bash
# conda κ°€μƒ ν™κ²½ μƒμ„± (Python 3.12)
conda create -n text_to_calendar python=3.12 -y

# κ°€μƒ ν™κ²½ ν™μ„±ν™”
conda activate text_to_calendar
```

### 3. μμ΅΄μ„± ν¨ν‚¤μ§€ μ„¤μΉ

ν”„λ΅μ νΈμ— ν•„μ”ν• λΌμ΄λΈλ¬λ¦¬λ¥Ό μ„¤μΉν•©λ‹λ‹¤. (`requirements.txt` νμΌμ΄ ν•„μ”ν•©λ‹λ‹¤.)

```bash
pip install -r requirements.txt
```

### 4. ν™κ²½ λ³€μ μ„¤μ •

ν”„λ΅μ νΈ λ£¨νΈ λ””λ ‰ν„°λ¦¬μ— `.env` νμΌμ„ μƒμ„±ν•κ³  μ•„λ λ‚΄μ©μ„ μ…λ ¥ν•©λ‹λ‹¤.
μ΄ νμΌμ€ `.gitignore`μ— ν¬ν•¨λμ–΄ Git μ¶”μ μ—μ„ μ μ™Έλ©λ‹λ‹¤.

```env
# .env

OLLAMA_URL = <Your Ollama Server URL>
OLLAMA_EMBEDDING_MODEL = <Your Ollama Embedding Model>>
OLLAMA_LLM_MODEL = <Your Ollama LLM Model>>

GPT_API_KEY = <Your OpenAI API Key>
GPT_LLM_MODEL = <Your GPT LLM Model>>

NOTION_TOKEN = <Your Notion Integration Token>
NOTION_DATABASE_ID = <Your Notion Database ID>
```

> ### π§­ Notion μ„¤μ • κ°€μ΄λ“ (μƒμ„Έ)
>
> μ΄ ν”„λ΅μ νΈκ°€ Notionκ³Ό μ—°λ™λκΈ° μ„ν•΄μ„λ” **ν†µν•©(Integration)** κ³Ό **λ°μ΄ν„°λ² μ΄μ¤(Database)** κ°€ μ¬λ°”λ¥΄κ² μ„¤μ •λμ–΄μ•Ό ν•©λ‹λ‹¤.
> μ•„λ λ‹¨κ³„λ¥Ό μμ„λ€λ΅ μ§„ν–‰ν•μ„Έμ”.
>
> #### π  1. μƒ μ›ν¬μ¤νμ΄μ¤ λλ” κΈ°μ΅΄ μ›ν¬μ¤νμ΄μ¤ μ¤€λΉ„
>
> 1.  **Notionμ— λ΅κ·ΈμΈ**ν•©λ‹λ‹¤: `https://www.notion.so`
> 2.  ν…μ¤νΈ λ©μ μ΄λΌλ©΄ **μƒ μ›ν¬μ¤νμ΄μ¤λ¥Ό μƒμ„±**ν•λ” κ²ƒμ„ κ¶μ¥ν•©λ‹λ‹¤.
>     -   μ™Όμ½ μ‚¬μ΄λ“λ°” ν•λ‹¨μ "μ›ν¬μ¤νμ΄μ¤ μ „ν™ β–Έ μƒ μ›ν¬μ¤νμ΄μ¤ λ§λ“¤κΈ°" ν΄λ¦­
>
> #### π“… 2. Notion λ°μ΄ν„°λ² μ΄μ¤ μƒμ„±
>
> 1.  Notionμ—μ„ μƒ νμ΄μ§€λ¥Ό λ§λ“­λ‹λ‹¤ (`+ μƒ νμ΄μ§€` ν΄λ¦­).
> 2.  νμ΄μ§€ νƒ€μ… μ¤‘ **"Empty database** μ„ μ„ νƒν•©λ‹λ‹¤.
>
> #### β™οΈ 3. Notion Integration (API ν† ν°) μƒμ„±
>
> 1.  Notion κ°λ°μ νμ΄μ§€μ— μ ‘μ†ν•©λ‹λ‹¤.
> 2.  **`+ μƒ ν†µν•© λ§λ“¤κΈ°`**λ¥Ό ν΄λ¦­ν•©λ‹λ‹¤.
> 3.  **μ΄λ¦„**μ„ "Text to Calendar" λ“±μΌλ΅ μ…λ ¥ν•κ³ , μ‚¬μ©ν•  **μ—°κ²°λ μ›ν¬μ¤νμ΄μ¤**λ¥Ό μ„ νƒν•©λ‹λ‹¤.
> 5.  `μ μ¶` ν›„, μƒμ„±λ **"λ‚΄λ¶€ ν†µν•© ν† ν°"** (`secret_...`) κ°’μ„ λ³µμ‚¬ν•μ—¬ `.env` νμΌμ `NOTION_TOKEN`μ— λ¶™μ—¬λ„£μµλ‹λ‹¤.
>
> #### π”— 4. Notion Calendarλ¥Ό λ°μ΄ν„°λ² μ΄μ¤μ— μ—°κ²°
>
> 1.  Notion Calendarλ΅ μ΄λ™ ν•©λ‹λ‹¤.,
> 2.  Notion λ°μ΄ν„°λ² μ΄μ¤ μ¶”κ°€λ¥Ό ν΄λ¦­ ν•©λ‹λ‹¤.
> 3.  Notion Calendarμ— λ°©κΈ μƒμ„±ν• νμ΄μ§€λ¥Ό μ¶”κ°€ ν•©λ‹λ‹¤.
>
> #### π†” 5. Notion λ°μ΄ν„°λ² μ΄μ¤ ID ν™•μΈ
>
> 1.  λ°μ΄ν„°λ² μ΄μ¤ νμ΄μ§€μ URL μ£Όμ†λ¥Ό ν™•μΈν•©λ‹λ‹¤.
> 2.  URLμ€ `https://www.notion.so/your-workspace/xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx?v=...`μ™€ κ°™μ€ ν•μ‹μ…λ‹λ‹¤.
> 3.  μ—¬κΈ°μ„ `xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx`μ— ν•΄λ‹Ήν•λ” λ¬Έμμ—΄μ΄ **λ°μ΄ν„°λ² μ΄μ¤ ID**μ…λ‹λ‹¤.
> 4.  μ΄ κ°’μ„ λ³µμ‚¬ν•μ—¬ `.env` νμΌμ `NOTION_DATABASE_ID`μ— λ¶™μ—¬λ„£μµλ‹λ‹¤.
>
> #### β… 7. .env νμΌ Notion μμ‹
>
> ```env
> NOTION_TOKEN="secret_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
> NOTION_DATABASE_ID="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
> ```
>
> μ΄μ  μ„¤μ •μ΄ μ™„λ£λμ—μµλ‹λ‹¤! π‰

---

## π€ μ‹¤ν–‰ λ°©λ²•

μ•„λ λ…λ Ήμ–΄λ¥Ό μ‹¤ν–‰ν•μ—¬ `FastMCP` μ„λ²„λ¥Ό μ‹μ‘ν•©λ‹λ‹¤. μ„λ²„λ” κΈ°λ³Έμ μΌλ΅ `8001` ν¬νΈμ—μ„ μ‹¤ν–‰λ©λ‹λ‹¤.

```bash
python app/server.py
```

μ„λ²„κ°€ μ •μƒμ μΌλ΅ μ‹¤ν–‰λλ©΄ λ‹¤μκ³Ό κ°™μ€ λ΅κ·Έκ°€ λ‚νƒ€λ‚©λ‹λ‹¤.

```
INFO:     Uvicorn running on http://0.0.0.0:8001 (Press CTRL+C to quit)
```

---

## π” ν΄λΌμ΄μ–ΈνΈ μ—°κ²° (MCP)

μ΄ μ„λ²„λ” MCP(Multi-tool Co-operative Protocol) μ„λ²„λ΅ λ™μ‘ν•λ©°, `gemini` CLIμ™€ κ°™μ€ ν΄λΌμ΄μ–ΈνΈκ°€ μ—°κ²°ν•μ—¬ `add_event_to_notion` ν΄μ„ μ‚¬μ©ν•  μ μλ„λ΅ ν•©λ‹λ‹¤.

ν΄λΌμ΄μ–ΈνΈλ¥Ό μ—°κ²°ν•λ ¤λ©΄ ν΄λΌμ΄μ–ΈνΈμ μ„¤μ • νμΌμ— μ„λ²„ μ •λ³΄λ¥Ό μ¶”κ°€ν•΄μ•Ό ν•©λ‹λ‹¤.

### Gemini CLI μ—°κ²° μμ‹

`gemini` CLIλ¥Ό μ‚¬μ©ν•λ” κ²½μ°, λ΅μ»¬ μ„¤μ • νμΌμ— μ•„λμ™€ κ°™μ΄ μ„λ²„ μ •λ³΄λ¥Ό μ¶”κ°€ν•©λ‹λ‹¤.

-   **Windows**: `C:\Users\<user_name>\.gemini\settings.json`
-   **macOS/Linux**: `~/.gemini/settings.json`

```json
{
  "mcpServers": {
    "notion-add-event": {
      "url": "http://127.0.0.1:8001/sse",
      "transport": "sse"
    }
  }
}
```

> `notion-add-event`λ” ν΄λΌμ΄μ–ΈνΈμ—μ„ μ‚¬μ©ν•  μ„λ²„μ λ³„μΉ­μ΄λ©°, μμ λ΅­κ² μ§€μ •ν•  μ μμµλ‹λ‹¤.

---

## β™οΈ μ›ν¬ν”λ΅μ° κµ¬μ΅° (LangGraph)

λ³Έ ν”„λ΅μ νΈλ” λ‹¤μκ³Ό κ°™μ€ 3κ°μ λ…Έλ“λ΅ κµ¬μ„±λ LangGraph μ›ν¬ν”λ΅μ°λ¥Ό μ‚¬μ©ν•©λ‹λ‹¤.

1.  **`init_notion_schema`**: μ›ν¬ν”λ΅μ° μ‹μ‘ μ‹, μ§€μ •λ Notion λ°μ΄ν„°λ² μ΄μ¤μ— `Name`(Title), `Date`(Date), `Description`(Rich Text) μ†μ„±μ΄ μλ”μ§€ ν™•μΈν•κ³  μ—†μΌλ©΄ μλ™μΌλ΅ μƒμ„±ν•©λ‹λ‹¤.
2.  **`extract_event`**: `init_notion_schema` μ™„λ£ ν›„, LLMμ„ μ‚¬μ©ν•μ—¬ μ‚¬μ©μ μ…λ ¥ ν…μ¤νΈμ—μ„ μ΄λ²¤νΈ μ •λ³΄(μ λ©, μ‹μ‘/μΆ…λ£ μ‹κ°„, μ„¤λ…)λ¥Ό JSON ν•μ‹μΌλ΅ μ¶”μ¶ν•©λ‹λ‹¤.
3.  **`add_to_notion`**: μ¶”μ¶λ μ΄λ²¤νΈ μ •λ³΄λ¥Ό λ°”νƒ•μΌλ΅ Notion APIλ¥Ό νΈμ¶ν•μ—¬ λ°μ΄ν„°λ² μ΄μ¤μ— μƒλ΅μ΄ νμ΄μ§€(μΌμ •)λ¥Ό μƒμ„±ν•©λ‹λ‹¤.

---

## π“– μ…λ ¥ λ° μ¶λ ¥ μμ‹

μ„λ²„κ°€ μ‹¤ν–‰ μ¤‘μΈ μƒνƒμ—μ„ `curl`κ³Ό κ°™μ€ λ„κµ¬λ¥Ό μ‚¬μ©ν•μ—¬ APIλ¥Ό νΈμ¶ν•  μ μμµλ‹λ‹¤.

### μ…λ ¥ (Request)

`add_event_to_notion` ν΄μ— μΌμ • μ •λ³΄λ¥Ό λ‹΄μ€ ν…μ¤νΈλ¥Ό `text` νλΌλ―Έν„°λ΅ μ „λ‹¬ν•©λ‹λ‹¤.

```bash
curl -X POST http://localhost:8001/tools/add_event_to_notion \
-H "Content-Type: application/json" \
-d '{"text": "λ‚΄μΌ μ¤ν›„ 3μ‹μ— λ§μΌ€ν… λ―Έν… μκ³ , λ¨λ  μ¤μ „ 9μ‹λ¶€ν„° 11μ‹κΉμ§€ λ””μμΈ μ›ν¬μƒµ μ§„ν–‰"}'
```

### μ¶λ ¥ (Response & Notion)

-   **API μ‘λ‹µ**: Notionμ— μ„±κ³µμ μΌλ΅ μ¶”κ°€λ μΌμ •μ κ°μμ™€ κ° νμ΄μ§€μ URLμ„ λ°ν™ν•©λ‹λ‹¤.
    ```
    β… 2κ°μ μΌμ •μ΄ Notionμ— μ¶”κ°€λμ—μµλ‹λ‹¤.
    https://www.notion.so/Marketing-Meeting-xxxxxxxx
    https://www.notion.so/λ””μμΈ-μ›ν¬μƒµ-yyyyyyyy
    ```
-   **Notion κ²°κ³Ό**: Notion λ°μ΄ν„°λ² μ΄μ¤μ— μ•„λμ™€ κ°™μ΄ 2κ°μ μΌμ •μ΄ μλ™μΌλ΅ μƒμ„±λ©λ‹λ‹¤.
    -   **λ§μΌ€ν… λ―Έν…**: (λ‚΄μΌ) μ¤ν›„ 3:00
    -   **λ””μμΈ μ›ν¬μƒµ**: (λ¨λ ) μ¤μ „ 9:00 - μ¤μ „ 11:00
